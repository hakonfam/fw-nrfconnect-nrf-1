#
# Copyright (c) 2020 Nordic Semiconductor ASA
#
# SPDX-License-Identifier: LicenseRef-Nordic-5-Clause
#

menu "Peripheral CPU DFU (PCD)"

menuconfig PCD
	bool "Peripheral CPU DFU Support (deprecated - use PCD_APP or PCD_NET)"
	select PCD_APP
	select PCD_NET

menuconfig PCD_APP
	bool "Peripheral CPU DFU Support for Application Processor"
	default y if SOC_SERIES_NRF53X && MCUBOOT && BT_RPMSG_NRF53

menuconfig PCD_NET
	bool "Peripheral CPU DFU Support for Network Processor"
	default y if SOC_NRF5340_CPUNET && IS_SECURE_BOOTLOADER
	select FLASH_PAGE_LAYOUT
	select STREAM_FLASH
	select STREAM_FLASH_ERASE

menuconfig PCD_USE_CONSTANTS
	bool "Use KConfig constants rather than pm_config.h"
	default n

if PCD_USE_CONSTANTS

menuconfig PCD_CMD_ADDRESS
	hex "PCD Command Address in RAM"
	default 0x2007e000

menuconfig NET_CORE_APP_OFFSET
	hex "Network Core Application Offset in Flash"
	default 0x8800

endif # PCD_USE_CONSTANTS

if PCD || PCD_APP || PCD_NET

module=PCD
module-dep=LOG
module-str=Peripheral Core DFU
source "$(ZEPHYR_BASE)/subsys/logging/Kconfig.template.log_config"

endif # PCD || PCD_NET || PCD_APP

if PCD_NET

config PCD_BUF_SIZE
	int
	default 512
	help
	  Must be <= the page size of the flash device.

endif # PCD_NET

endmenu
